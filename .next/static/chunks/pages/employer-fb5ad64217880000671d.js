(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[515],{7721:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return N}});var r=t(1163),a=t(7294),o=t(4552),l=t(5893),i=function(e){var n=e.data,t=e.isLoading,r=e.isError,a=e.error,i=e.onJobEdit;return(0,l.jsx)(l.Fragment,{children:t?(0,l.jsx)("div",{children:"Loading..."}):r?(0,l.jsxs)("div",{children:["Error: ",a.message]}):(0,l.jsx)("div",{children:null===n||void 0===n?void 0:n.map((function(e){return(0,l.jsx)(o.Z,{result:e,freeLancerId:"",isEmployerScreen:!0,onJobApply:null,onJobEdit:i},e.ID)}))})})},s=t(2809),c=t(266),u=t(809),d=t.n(u),f=t(8737),p=t(7547),b=t(8767),m=t(5665),v=function(){var e=(0,c.Z)(d().mark((function e(n){var t,r,a,o,l,i,s,c,u,f,p;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",null);case 2:return t=n.empId,r=n.ID,a=n.jobTitle,o=n.jobDescription,l=n.jobRequirements,i=n.skills,s=n.salary,c=n.companyName,u=n.contactInfo,f='mutation {\n    createOrUpdateJob(newJob: {ID: "'.concat(r,'", jobTitle: "').concat(a,'", jobDescription: "').concat(o,'",\n       jobRequirements: "').concat(l,'", skills: "').concat(i,'",\n        salary: ').concat(s,', companyName: "').concat(c,'", contactInfo: "').concat(u,'"\n      }, empId: "').concat(t,'")\n      {\n        ID\n        jobTitle\n        jobDescription\n        jobRequirements\n        salary\n        appliedBy\n        companyName\n        contactInfo\n        skills\n        postedAt\n      }\n  }'),e.next=6,(0,m.Z)("createOrUpdateJob",f);case 6:return p=e.sent,e.abrupt("return",p);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var j=t(5379),y=t(5080);function x(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function h(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?x(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):x(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var I=function(e){switch(e){case"jobDescription":return 16e3;case"companyName":return 50;case"jobRequirements":return 10;case"jobTitle":return 50;default:return 100}},g=function(e){switch(e){case"contactInfo":return"tel";case"salary":return"number";default:return"text"}},w=function(e){switch(e){case"salary":return{max:30,min:0};default:return{maxLength:I(e)}}},D=function(e){var n=e.empId,t=e.onSubmitCB,r=e.editJob,o=e.isEdit,i=void 0!==o&&o,u=[{val:"ID",label:"Job Id",default:""},{val:"jobTitle",label:"Job Title",default:""},{val:"jobDescription",label:"Job Description",default:""},{val:"jobRequirements",label:"Job Requirements",default:""},{val:"companyName",label:"Company Name",default:""},{val:"contactInfo",label:"Contact Info",default:""},{val:"salary",label:"Salary",default:""},{val:"skills",label:"Skills",default:[]}],m=u.reduce((function(e,n){return e[n.val]=i?r[n.val]:n.default,e}),{empId:n}),x=(0,a.useState)(m),I=x[0],D=x[1],k=(0,a.useState)(!1),E=k[0],N=k[1],O=function(e){var n=(0,b.useQueryClient)();return(0,b.useMutation)(v,{onSuccess:function(t){var r=n.getQueryData(["jobsByEmployer",{empId:e}]),a=r.findIndex((function(e){return e.ID===t.ID})),o=!1;r.map((function(e){e.ID===t.ID&&(r.splice(a,1,t),o=!0)})),o||r.unshift(t),n.setQueryData(["jobsByEmployer",{empId:e}],r)}})}(n),C=(0,a.useState)(!0),J=C[0],P=C[1],S=function(){var e=(0,c.Z)(d().mark((function e(){var r,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new RegExp(/(7|8|9)\d{9}/),a=Object.values(I).some((function(e){return null===e||""===e||0===(null===e||void 0===e?void 0:e.length)})),r.test(I.contactInfo)||(a=!0,P(!1)),r.test(I.contactInfo)&&P(!0),!a){e.next=7;break}return N(!0),e.abrupt("return");case 7:if(e.t0=!a,!e.t0){e.next=11;break}return e.next=11,O.mutate(I,n);case 11:t();case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"pv2 flex flex-column",children:[J&&E&&(0,l.jsx)("div",{className:"bg-red pv2 mb3 b white ph1 f6",children:"\u26a0 Please fill all details before you update"}),!J&&(0,l.jsx)("div",{className:"bg-red pv2 mb3 b white ph1 f6",children:"\u26a0 Please provide a valid 10 digit phone number"}),u.map((function(e,n){if("skills"!==e.val)return(0,l.jsxs)("div",{className:"flex flex-column",children:[(0,l.jsx)("label",{className:"tl mb2",children:e.label}),"jobDescription"===e.val?(0,l.jsx)("textarea",{maxLength:"16000",rows:"8",cols:"50",value:I[e.val],onChange:function(n){return D(h(h({},I),{},(0,s.Z)({},e.val,n.target.value)))}}):(0,l.jsx)("input",h(h({className:"tl pa1"},w(e.val)),{},{type:g(e.val),value:I[e.val],onChange:function(n){return D(h(h({},I),{},(0,s.Z)({},e.val,n.target.value)))}}))]},n)})),(0,l.jsx)("div",{className:"mv2",children:"Skills"}),(0,l.jsx)(f.ZP,{isMulti:!0,options:p.p,defaultValue:(0,y.T)(I.skills),onChange:function(e){return D(h(h({},I),{},{skills:e.map((function(e){return e.value}))}))}}),(0,l.jsx)("div",{className:"flex justify-center mt3",children:(0,l.jsx)(j.Z,{className:"w-20",onClick:S,children:i?"Update":"Create"})})]})})},k=function(){var e=(0,c.Z)(d().mark((function e(n){var t,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return t="{\n    getAllPostedJobsByEmployer(empId: ".concat(n,") {\n      ID\n      jobTitle\n      jobDescription\n      jobRequirements\n      salary\n      companyName\n      contactInfo\n      skills\n      postedAt\n      appliedBy\n    }\n  }"),e.next=5,(0,m.Z)("getAllPostedJobsByEmployer",t);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var E=t(2525),N=function(){var e,n,t=null===(e=(0,r.useRouter)().query)||void 0===e?void 0:e.employerId,o=(0,a.useState)(!1),s=o[0],c=o[1],u=(0,a.useState)(!1),d=u[0],f=u[1],p=(0,a.useState)(null),m=p[0],v=p[1],y=(n=t,(0,b.useQuery)(["jobsByEmployer",{empId:n}],(function(){return k(n)}))),x=y.isLoading,h=y.isError,I=y.error,g=y.data;return(0,l.jsxs)("div",{className:"marginMiddle pt6 flex flex-column items-center",children:[(0,l.jsx)(E.Z,{openModal:s,onClose:function(){return c(!1)},children:(0,l.jsx)(D,{empId:t,onSubmitCB:function(){return c(!1)},isEdit:d,editJob:m})}),(0,l.jsx)(j.Z,{className:"w-20-l mb4",onClick:function(){f(!1),c(!0)},children:"Create a new job"}),(0,l.jsx)(i,{isLoading:x,isError:h,error:I,data:g,onJobEdit:function(e){var n,t=null===(n=g.filter((function(n){return n.ID===e})))||void 0===n?void 0:n[0];v(t),c(!0),f(!0)}})]})}},7720:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/employer",function(){return t(7721)}])}},function(e){e.O(0,[774,445,526,552,888,179],(function(){return n=7720,e(e.s=n);var n}));var n=e.O();_N_E=n}]);